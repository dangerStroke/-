webpackJsonp([17],{"1rNc":function(t,e){},wNzM:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),n={name:"UE",data:function(){return{editor:null}},props:{defaultMsg:{type:String},config:{type:Object}},mounted:function(){var t=this;this.editor=UE.getEditor("editor",this.config),this.editor.addListener("ready",function(){t.editor.setContent(t.defaultMsg)})},methods:{getUEContent:function(){return console.log(this.editor),this.editor.getContent()}},destroyed:function(){this.editor.destroy()}},o={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("script",{attrs:{id:"editor",type:"text/plain"}})])}]},c={name:"addProduct",components:{UE:s("VU/8")(n,o,!1,null,null,null).exports},data:function(){return{content:"",upData:{token:""},projectInfo:{top:"",title:"",desc:"",cover:"",imgs:"",location_start:"",location_assemble:"",location_dismiss:"",focus:"",location_travel:"",price_info:"",notice:"",price:"",desc2:"",price_child:""},img_json:[],change:!1,isDetail:!1,detail:"",config:{initialFrameWidth:null,initialFrameHeight:300},defaultMsg:"container"}},created:function(){if("modify"==this.$route.query.type){var t=this.$route.query.detail;t&&(console.log(JSON.parse(t).imgs),this.projectInfo=JSON.parse(t),this.img_json=JSON.parse(JSON.parse(t).imgs),this.change=!0,this.detail=JSON.parse(t))}else if("detail"==this.$route.query.type){var e=this.$route.query.detail;e&&(this.projectInfo=JSON.parse(e),this.img_json=JSON.parse(JSON.parse(e).imgs),this.isDetail=!0,this.detail=JSON.parse(e))}},mounted:function(){this.getToken()},methods:{submit:function(){var t=this;if(this.isDetail)this.isDetail&&window.history.back(-1);else{var e=this.$refs.ue.getUEContent();this.projectInfo.location_travel=e,console.log(e);var s=this.projectInfo;s.imgs=a()(this.img_json),s.price=Number(s.price),s.price_child=Number(s.price_child),s.title?s.desc?s.cover?s.imgs?s.price_info<0?this.$Message.warning("活动费用必须大于0"):s.notice?!s.price<0?this.$Message.warning("成人票价不能小于0"):!s.price_child<0?this.$Message.warning("儿童票价不能小于0"):s.location_start?s.location_dismiss?s.location_assemble?s.focus?s.desc2?(console.log(this.change),this.change?(s.id=this.detail.id,this.$post("/admin/travel-around-edit",s).then(function(e){200==e.code&&e.data?(t.$Message.warning("修改成功"),window.history.back(-1)):t.$Message.warning(e.error)})):this.$post("/admin/travel-around-add",s).then(function(e){200==e.code&&e.data?(t.$Message.warning("保存成功"),window.history.back(-1)):t.$Message.warning(e.error)})):this.$Message.warning("出游地详情不能为空"):this.$Message.warning("两点不能为空"):this.$Message.warning("集合地点不能为空"):this.$Message.warning("解散地点不能为空"):this.$Message.warning("出发地点不能为空"):this.$Message.warning("项目须知不能为空"):this.$Message.warning("请上传详情图片"):this.$Message.warning("请上传封面图片"):this.$Message.warning("请填写项目副标题"):this.$Message.warning("请填写项目标题")}},getToken:function(){var t=this;this.$fetch("/admin/index/get-upload-token").then(function(e){200===e.code?t.upData.token=e.data:t.$Message.warning(e.error)})},handleSuccess:function(t){console.log(t);var e="http://static2.jd-gz.com/"+t.key;this.projectInfo.cover=e},handleSuccessList:function(t){if(this.img_json.length<8){var e="http://static2.jd-gz.com/"+t.key;this.img_json.push(e)}else this.$Message.warning("不能超出八张")},goback:function(){console.log(123),window.history.back(-1)},deletaImg:function(t){this.img_json.splice(t,1)},showDelete:function(t,e){var s="delete"+t,i=document.getElementById(s);i.style.opacity="enter"===e?1:0},isOK:function(){var t=this.$refs.ue.getUEContent();this.projectInfo.location_travel=t,console.log(t)}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add_box"},[s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("排序")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入排序",maxlength:20},model:{value:t.projectInfo.top,callback:function(e){t.$set(t.projectInfo,"top",e)},expression:"projectInfo.top"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("标题：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:t.projectInfo.title,callback:function(e){t.$set(t.projectInfo,"title",e)},expression:"projectInfo.title"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("副标题：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入副标题：",maxlength:20},model:{value:t.projectInfo.desc,callback:function(e){t.$set(t.projectInfo,"desc",e)},expression:"projectInfo.desc"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("封面图片：")]),t._v(" "),s("div",{staticClass:"image_box"},[s("div",{staticClass:"upload_box"},[s("Upload",{ref:"upload",staticClass:"upload_btn",attrs:{format:["jpg","jpeg","png"],accept:"'jpg', 'jpeg', 'png'",name:"file",data:t.upData,"on-success":t.handleSuccess,action:"http://up-z0.qiniup.com","show-upload-list":!1,"max-size":2048}},[s("Icon",{staticClass:"upload_icon",attrs:{type:"ios-add"}}),t._v(" "),t.projectInfo.cover?s("img",{staticClass:"img",attrs:{src:t.projectInfo.cover}}):t._e()],1)],1)])]),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("详情图片：")]),t._v(" "),s("div",{staticClass:"upload_content"},[s("div",{staticClass:"image_box "},[s("div",{staticClass:"upload_box"},[s("Upload",{ref:"upload",staticClass:"upload_btn",attrs:{format:["jpg","jpeg","png"],accept:"'jpg', 'jpeg', 'png'",name:"file",data:t.upData,"on-success":t.handleSuccessList,action:"http://up-z0.qiniup.com","show-upload-list":!1}},[s("Icon",{staticClass:"upload_icon",attrs:{type:"ios-add"}})],1)],1)]),t._v(" "),t._l(t.img_json,function(e,i){return s("div",{key:i,staticClass:"image_box upload_image_box",on:{mouseenter:function(e){return t.showDelete(i,"enter")},mouseleave:function(e){return t.showDelete(i,"out")}}},[s("div",{staticClass:"upload_box"},[s("img",{attrs:{src:e,alt:""}})]),t._v(" "),s("Icon",{staticClass:"delete_icon",attrs:{type:"ios-trash-outline",size:"80",id:"delete"+i},on:{click:function(e){return t.deletaImg(i)}}})],1)})],2)]),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("出发地点：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:t.projectInfo.location_start,callback:function(e){t.$set(t.projectInfo,"location_start",e)},expression:"projectInfo.location_start"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("集合地点：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:t.projectInfo.location_assemble,callback:function(e){t.$set(t.projectInfo,"location_assemble",e)},expression:"projectInfo.location_assemble"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("解散地点：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:t.projectInfo.location_dismiss,callback:function(e){t.$set(t.projectInfo,"location_dismiss",e)},expression:"projectInfo.location_dismiss"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("亮点：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",type:"textarea",maxlength:1e3},model:{value:t.projectInfo.focus,callback:function(e){t.$set(t.projectInfo,"focus",e)},expression:"projectInfo.focus"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("出游地详情：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",type:"textarea",maxlength:1e3},model:{value:t.projectInfo.desc2,callback:function(e){t.$set(t.projectInfo,"desc2",e)},expression:"projectInfo.desc2"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("活动费用：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",type:"textarea",maxlength:1e3},model:{value:t.projectInfo.price_info,callback:function(e){t.$set(t.projectInfo,"price_info",e)},expression:"projectInfo.price_info"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("活动须知：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",type:"textarea",maxlength:1e3},model:{value:t.projectInfo.notice,callback:function(e){t.$set(t.projectInfo,"notice",e)},expression:"projectInfo.notice"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("成人价：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:t.projectInfo.price,callback:function(e){t.$set(t.projectInfo,"price",e)},expression:"projectInfo.price"}})],1),t._v(" "),s("div",{staticClass:"add_single"},[s("p",{staticClass:"single_left"},[t._v("儿童价：")]),t._v(" "),s("Input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:t.projectInfo.price_child,callback:function(e){t.$set(t.projectInfo,"price_child",e)},expression:"projectInfo.price_child"}})],1),t._v(" "),s("UE",{ref:"ue",attrs:{defaultMsg:t.defaultMsg,config:t.config}}),t._v(" "),s("div",{staticClass:"btn_box"},[t.isDetail?t._e():s("Button",{staticClass:"coo_btn",attrs:{type:"dashed"},on:{click:t.goback}},[t._v("取消")]),t._v(" "),t.isDetail?t._e():s("Button",{staticClass:"coo_btn",attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存")])],1)],1)},staticRenderFns:[]};var r=s("VU/8")(c,l,!1,function(t){s("1rNc")},null,null);e.default=r.exports}});
//# sourceMappingURL=17.1628c8adf8ea0907fe81.js.map