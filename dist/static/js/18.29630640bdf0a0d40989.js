webpackJsonp([18],{"8ohl":function(t,s){},"d/fK":function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});a("P9l9"),a("YW59"),a("mtWM");var e={data:function(){return{page:1,pagesize:10,columns:[{title:"操作",slot:"action",align:"center",width:300},{type:"index",title:"序号",width:80,align:"center"},{title:"订单状态",slot:"status",width:120},{title:"订单编号",key:"order_sn",width:180},{title:"预订人",key:"name",width:160},{title:"预订人电话",key:"phone",width:160},{title:"周边游项目",key:"title",width:200},{title:"发车时间",key:"date",width:180},{title:"订单创建时间",key:"created_at",width:180}],listData:[],total:0,refundId:"",cancleId:"",changeType:"",orderId:"",uid:"",modalText:"您确定要删除选中项目吗？",showModal:!1,status:"",order_sn:"",date:"",statusArr:[{label:"待支付",value:1},{label:"已支付",value:2},{label:"已取消",value:3},{label:"支付失败",value:4},{label:"已完成",value:5},{label:"已评价",value:6},{label:"已退款",value:7},{label:"退款中",value:8}],showDetail:!1,detailInfo:{},priceData:[],priceColum:[{title:"类目",key:"title"},{title:"金额",key:"price"}],carList:[]}},created:function(){this.getOrderList(""),this.getCarList()},methods:{bindCar:function(){var t=this;if(this.detailInfo.car_id){var s={order_sn:this.detailInfo.order_sn,car_id:this.detailInfo.car_id};this.$post("/admin/throughtrain/attach-car",s).then(function(s){200===s.code&&s.data?(t.$Message.success("指派车辆成功"),t.closeDeatil(),t.getOrderList("")):t.$Message.warning(s.error)})}else this.$Message.warning("请选择指派的车辆")},closeDeatil:function(){this.showDetail=!1,this.detailInfo={}},getCarList:function(){var t=this;this.$fetch("/admin/index/select-throughtrain-car").then(function(s){if(200===s.code){var a=[];if(s.data){var e=s.data;for(var i in e){var l={value:i,label:e[i]};a.push(l)}}t.carList=a}})},countPrice:function(){var t=(this.detailInfo.price/100).toFixed(2),s=[];s=8==this.detailInfo.status?[{title:"周边游费用",price:t},{title:"退款",price:t},{title:"总计",price:0}]:[{title:this.detailInfo.title,price:t},{title:"总计",price:(this.detailInfo.price/100).toFixed(2)}],this.priceData=s,this.detailInfo.priceStr=(this.detailInfo.price/100).toFixed(2)},bindDetail:function(t){this.detailInfo=t,this.showDetail=!0,this.countPrice()},initData:function(){this.status="",this.orderId="",this.date="",this.getOrderList("")},dateChange:function(t){this.date=t},bindConfirm:function(){var t=this,s=this.order_sn,a=(this.uid,this.changeType),e={},i="",l="";console.log(a),"cancleId"===a?(e={order_sn:s},i="/admin/travel-around-cancel",l="取消成功",this.$fetch(i,e).then(function(s){console.log(s),200==s.code?(t.modalChange("","cancle",{}),t.getOrderList(""),t.$Message.success(l)):(t.modalChange("","cancle",{}),t.getOrderList(""),t.$Message.warning(s.error))})):"refundId"===a?(e={order_sn:s},i="/admin/travel-around-refund",l="退款成功",this.$fetch(i,e).then(function(s){200==s.code?(t.modalChange("","cancle",{}),t.getOrderList(""),t.$Message.success(l)):(t.modalChange("","cancle",{}),t.getOrderList(""),t.$Message.warning(s.error))})):"completeId"===a&&(e={order_sn:s},i="/admin/travel-around-complete",l="订单完成",this.$fetch(i,e).then(function(s){console.log(s),200==s.code?(t.modalChange("","cancle",{}),t.getOrderList(""),t.$Message.success(l)):(t.modalChange("","cancle",{}),t.getOrderList(""),t.$Message.warning(s.error))}))},modalChange:function(t,s,a){"show"===s?(this.changeType=t,this.order_sn=a.order_sn,this.uid=a.uid,this.showModal=!0):(this.showModal=!1,this.order_sn="",this.uid="",this.changeType="")},changePage:function(t){this.page=t,this.getOrderList("page")},getOrderList:function(t){var s=this;"page"!==t&&(this.page=1);this.page,this.pagesize;var a=this.status,e=this.orderId,i={page:1,pagesize:999999,status:a,date:this.date};i.order_sn=e,this.$fetch("/admin/travel-around-order-list",i).then(function(t){200===t.code?(t.data.data.forEach(function(t){t.title=t.travel_around.title}),s.listData=t.data.data,s.total=t.data.total):s.$Message.warning(t.error)})}}},i={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"throughOrder"},[a("div",{staticClass:"search_box"},[a("div",{staticClass:"search_left"},[a("div",{staticClass:"search_single"},[a("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入订单编号"},model:{value:t.orderId,callback:function(s){t.orderId=s},expression:"orderId"}})],1),t._v(" "),a("div",{staticClass:"search_single"},[a("Select",{staticStyle:{width:"180px"},attrs:{placeholder:"订单状态"},model:{value:t.status,callback:function(s){t.status=s},expression:"status"}},t._l(t.statusArr,function(s){return a("Option",{key:s.value,attrs:{value:s.value}},[t._v(t._s(s.label))])}),1)],1),t._v(" "),a("div",{staticClass:"search_single"},[a("DatePicker",{staticStyle:{width:"180px"},attrs:{value:t.date,type:"date",placeholder:"选择出发日期"},on:{"on-change":t.dateChange}})],1)]),t._v(" "),a("div",{staticClass:"search_right"},[a("Button",{attrs:{type:"primary"},on:{click:function(s){return t.getOrderList("")}}},[t._v("搜索")]),t._v(" "),a("Button",{attrs:{type:"error"},on:{click:t.initData}},[t._v("清空")])],1)]),t._v(" "),a("div",{staticClass:"table_box"},[a("Table",{attrs:{border:"",columns:t.columns,data:t.listData},scopedSlots:t._u([{key:"status",fn:function(s){var e=s.row;return[1==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   待支付\n                ")]):t._e(),t._v(" "),2==e.status?a("div",{staticClass:"img_box"},[t._v("\n                  已支付\n                ")]):t._e(),t._v(" "),3==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   已取消\n                ")]):t._e(),t._v(" "),4==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   支付失败\n                ")]):t._e(),t._v(" "),5==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   已完成\n                ")]):t._e(),t._v(" "),6==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   已评价\n                ")]):t._e(),t._v(" "),7==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   已退款\n                ")]):t._e(),t._v(" "),8==e.status?a("div",{staticClass:"img_box"},[t._v("\n                   退款中\n                ")]):t._e()]}},{key:"ticket",fn:function(s){var e=s.row;return[e.num>0?a("div",{staticClass:"img_box"},[t._v("\n                   "+t._s(e.num)+"张\n                ")]):a("div",{staticClass:"img_box"},[t._v("\n                   无\n                ")])]}},{key:"action",fn:function(s){var e=s.row;return[a("Button",{attrs:{type:"primary"},on:{click:function(s){return t.bindDetail(e)}}},[t._v("查看详情")]),t._v(" "),1===e.status?a("Button",{attrs:{type:"info"},on:{click:function(s){return t.modalChange("cancleId","show",e)}}},[t._v("取消")]):t._e(),t._v(" "),2===e.status?a("Button",{attrs:{type:"info"},on:{click:function(s){return t.modalChange("completeId","show",e)}}},[t._v("完成")]):t._e(),t._v(" "),2===e.status?a("Button",{attrs:{type:"error"},on:{click:function(s){return t.modalChange("refundId","show",e)}}},[t._v("退款")]):t._e()]}}])}),t._v(" "),a("div",{staticClass:"page_box"},[a("div",{staticClass:"page_left"},[t._v("\n                共"+t._s(t.total)+"条记录 第"+t._s(t.page)+"/"+t._s(Math.ceil(t.total/t.pagesize))+"页\n            ")]),t._v(" "),a("div",{staticClass:"page_right"},[a("Page",{attrs:{total:t.total,"page-size":t.pagesize,current:t.page},on:{"on-change":t.changePage}})],1)])],1),t._v(" "),a("Modal",{staticClass:"delete_box",attrs:{"mask-closable":!1,closable:!1,width:"400"},model:{value:t.showModal,callback:function(s){t.showModal=s},expression:"showModal"}},["cancleId"===t.changeType?a("div",{staticClass:"content"},[a("p",[t._v("您确定要取消选中的订单吗？")])]):t._e(),t._v(" "),"refundId"===t.changeType?a("div",{staticClass:"content"},[a("p",[t._v("您确定要对选中的订单进行退款吗？")])]):t._e(),t._v(" "),"completeId"===t.changeType?a("div",{staticClass:"content"},[a("p",[t._v("您确定要对选中的订单进行完成操作吗？")])]):t._e(),t._v(" "),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"cancle_btn",attrs:{type:"default"},on:{click:function(s){return t.modalChange("refundId","cancle",t.row)}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.bindConfirm}},[t._v("确定")])],1)]),t._v(" "),a("Modal",{staticClass:"detail_modal",attrs:{"mask-closable":!1,closable:!1,title:"直通车订单",width:"780"},model:{value:t.showDetail,callback:function(s){t.showDetail=s},expression:"showDetail"}},[a("div",{staticClass:"content"},[a("div",{staticClass:"content_top"},[a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("订单类型:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v("直通车")])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("订单号:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.order_sn))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("订单状态:")]),t._v(" "),1===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("待支付")]):t._e(),t._v(" "),2===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已支付")]):t._e(),t._v(" "),3===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已取消")]):t._e(),t._v(" "),4===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("支付失败")]):t._e(),t._v(" "),5===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已完成")]):t._e(),t._v(" "),6===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已评价")]):t._e(),t._v(" "),7===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已退款")]):t._e(),t._v(" "),8===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("退款中")]):t._e()]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("支付状态:")]),t._v(" "),1===t.detailInfo.status||3===t.detailInfo.status||4===t.detailInfo.status||7===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("支付失败")]):t._e(),t._v(" "),2===t.detailInfo.status||5===t.detailInfo.status||6===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("支付成功")]):t._e(),t._v(" "),8===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("退款中")]):t._e()]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("取消时间:")]),t._v(" "),t.detailInfo.cancel_time?a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.cancel_time))]):t._e()]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("创建时间:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.created_at))])])]),t._v(" "),a("div",{staticClass:"content_bottom"},[a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("预订人:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.name))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("电话:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.phone))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("预约日期:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.date))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("项目名称:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.title))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("上车地点:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.location_start))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("成人:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.num)+"人")])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("儿童:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.num_children)+"人")])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("价格:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.priceStr)+"元")])])]),t._v(" "),a("div",{staticClass:"notice_box"},[a("p",{staticClass:"notice_left"},[t._v("备注：")]),t._v(" "),t.detailInfo.remark?a("p",[t._v(t._s(t.detailInfo.remark))]):a("p",[t._v("无")])]),t._v(" "),a("div",{staticClass:"table_box"},[a("Table",{attrs:{border:"",columns:t.priceColum,data:t.priceData}})],1)]),t._v(" "),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"cancle_btn",attrs:{type:"default"},on:{click:t.closeDeatil}},[t._v("取消")]),t._v(" "),2==t.detailInfo.status?a("Button",{attrs:{type:"primary"},on:{click:t.bindCar}},[t._v("确定")]):t._e()],1)])],1)},staticRenderFns:[]};var l=a("VU/8")(e,i,!1,function(t){a("8ohl")},null,null);s.default=l.exports}});
//# sourceMappingURL=18.29630640bdf0a0d40989.js.map