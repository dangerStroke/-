webpackJsonp([19],{kD2b:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("P9l9"),a("YW59");var s=a("mtWM"),i=a.n(s),l={data:function(){return{page:1,pagesize:10,columns:[{title:"操作",slot:"action",align:"center",width:300},{type:"index",title:"序号",width:80,align:"center"},{title:"订单类型",key:"type",width:120},{title:"订单状态",slot:"status",width:120},{title:"订单编号",key:"order_sn",width:200},{title:"车型",key:"carName",width:180},{title:"预订人",key:"name",width:160},{title:"预订人电话",key:"phone",width:160},{title:"预定天数",key:"days",width:100},{title:"出发日期",key:"stime",width:180},{title:"订单创建时间",key:"created_at",width:180}],listData:[],total:0,refundId:"",cancleId:"",changeType:"",orderId:"",uid:"",modalText:"您确定要删除选中订单吗？",showModal:!1,status:"",order_sn:"",date:"",created_at:"",btime:"",statusArr:[{label:"待支付",value:1},{label:"已支付",value:2},{label:"已取消",value:3},{label:"支付失败",value:4},{label:"已完成",value:5},{label:"已评价",value:6},{label:"已退款",value:7},{label:"退款中",value:8},{label:"进行中",value:9},{label:"审核中",value:10}],showDetail:!1,detailInfo:{},priceData:[],userData:[],carList:[],model1:"",placeholder:"",refund_price:""}},created:function(){this.getOrderList("")},methods:{getCarList:function(){var t=this,e={stime:this.detailInfo.stime,etime:this.detailInfo.etime},a=[];this.$fetch("/charter/list-model",e).then(function(e){if(200==e.code&&e.data){var s=function(t){console.log(e.data[t]),e.data[t].map(function(e){var s={value:e.id,label:e.name+t+"座"};a.push(s)})};for(var i in e.data)s(i);t.carList=a,console.log(a)}})},carmodelChoose:function(t){console.log(t),this.detailInfo.car_model_id=t},examine:function(){var t=this,e=this.detailInfo,a=e.order_sn,s=e.stime,i=e.etime,l=e.slocation,n=e.elocation,o=e.member,r=e.child,d=e.old,c=e.name,_=e.phone,v=e.id_card_number,u=e.price,p=e.service,g=e.car_model_id,m={order_sn:a,stime:s,etime:i,slocation:l,elocation:n,member:o,child:r,old:d,name:c,phone:_,id_card_number:v,price:100*u,service:p,car_model_id:g,status:1};v&&u&&g?this.$fetch("/admin/charter-custom/edit-order",m).then(function(e){200===e.code?(t.$Message.success("审核通过"),t.closeDeatil()):t.$Message.warning(e.error)}):v?u?g||this.$Message.warning("请选择车型"):this.$Message.warning("请填写价格"):this.$Message.warning("请填写身份证")},closeDeatil:function(){this.getOrderList(),this.showDetail=!1,this.detailInfo={}},countPrice:function(){var t=[{title:"定制包车",price:(this.detailInfo.car_model.price/100).toFixed(2)+"/天"},{title:"总计",price:(this.detailInfo.price/100).toFixed(2)}];this.priceData=t,this.detailInfo.priceStr=(this.detailInfo.price/100).toFixed(2)},bindDetail:function(t){t.price=(t.price/100).toFixed(2),0!=t.car_model.length?(this.model1=t.car_model.name+t.car_model.ridership+"座",this.placeholder=t.car_model.name+t.car_model.ridership+"座"):this.placeholder="请选择",this.detailInfo=t,this.showDetail=!0,this.countPrice(),this.getCarList()},initData:function(){this.status="",this.orderId="",this.date="",this.created_at="",this.getOrderList("")},dateChange:function(t){this.date=t},created_atChange:function(t){this.created_at=t},bindConfirm:function(){var t=this,e=this.order_sn,a=this.refund_price,s=this.changeType,i={},l="",n="";"cancleId"===s?(i={order_sn:e},l="/admin/pay/cancel",n="取消成功"):"refundId"===s&&(i={order_sn:e,refund_price:100*a},l="/admin/pay/refund",n="退款成功"),"completeId"!==s?this.$post(l,i).then(function(e){t.modalChange("","cancle",{}),t.getOrderList(""),200===e.code?t.$Message.success(n):t.$Message.warning(e.error)}):this.$post(l,i).then(function(e){t.modalChange("","cancle",{}),t.getOrderList(""),200===e.code?e.data?t.$Message.success(n):t.$Message.warning("操作失败"):t.$Message.warning(e.error)})},modalChange:function(t,e,a){"show"===e?(this.changeType=t,this.order_sn=a.order_sn,this.uid=String(a.uid),this.showModal=!0):(this.showModal=!1,this.order_sn="",this.uid="",this.changeType="")},changePage:function(t){this.page=t,this.getOrderList("page")},getOrderList:function(t){var e=this;"page"!==t&&(this.page=1);var a=this.page,s=this.pagesize,i=this.status,l=this.orderId,n=this.date,o={page:a,page_size:s,status:i,order_sn:l,created_at:this.created_at,stime:n};this.$fetch("/admin/charter-custom/list-order",o).then(function(t){if(200===t.code){var a;a=t.data.data.map(function(t){return""!=t.car_model?t.carName=t.car_model.name+t.car_model.ridership+"座":t.carName="暂无数据",t}),e.listData=a,e.total=t.data.total}else e.$Message.warning(t.error)})},subExcel:function(){var t=this.page,e=this.pagesize,a=this.status,s=this.orderId,l={page:t,page_size:e,status:a,date:this.date,order_sn:s,created_at:this.created_at},n=window.location.host,o="";o="localhost:8080"==n||"dev-admin.jd-gz.com"==n?"http://dev.jd-gz.com/admin/scenic-area/gets-excel":"admin.jd-gz.com"==n?"http://api.jd-gz.com/admin/scenic-area/gets-excel":"http://adminlocal/admin/scenic-area/gets-excel",i.a.get(o,{params:l,responseType:"blob"}).then(function(t){var e=t.data,a=new FileReader;a.readAsDataURL(e),a.onload=function(t){var e=document.createElement("a");e.download="景区快客订单报表.xls",e.href=t.target.result,document.body.appendChild(e),e.click(),document.body.removeChild(e)}}).catch(function(t){console.log(t.message)})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"throughOrder"},[a("div",{staticClass:"search_box"},[a("div",{staticClass:"search_left"},[a("div",{staticClass:"search_single"},[a("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入订单编号"},model:{value:t.orderId,callback:function(e){t.orderId=e},expression:"orderId"}})],1),t._v(" "),a("div",{staticClass:"search_single"},[a("Select",{staticStyle:{width:"180px"},attrs:{placeholder:"订单状态"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusArr,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),a("div",{staticClass:"search_single"},[a("DatePicker",{staticStyle:{width:"180px"},attrs:{value:t.date,type:"date",placeholder:"选择出发日期"},on:{"on-change":t.dateChange}})],1),t._v(" "),a("div",{staticClass:"search_single"},[a("DatePicker",{staticStyle:{width:"180px"},attrs:{value:t.created_at,type:"date",placeholder:"选择下单日期"},on:{"on-change":t.created_atChange}})],1)]),t._v(" "),a("div",{staticClass:"search_right"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.getOrderList("")}}},[t._v("搜索")]),t._v(" "),a("Button",{attrs:{type:"error"},on:{click:t.initData}},[t._v("清空")])],1)]),t._v(" "),a("div",{staticClass:"table_box"},[a("Table",{attrs:{border:"",columns:t.columns,data:t.listData},scopedSlots:t._u([{key:"status",fn:function(e){var s=e.row;return[1==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   待支付\n                ")]):t._e(),t._v(" "),2==s.status?a("div",{staticClass:"img_box"},[t._v("\n                  已支付\n                ")]):t._e(),t._v(" "),3==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   已取消\n                ")]):t._e(),t._v(" "),4==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   支付失败\n                ")]):t._e(),t._v(" "),5==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   已完成\n                ")]):t._e(),t._v(" "),6==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   已评价\n                ")]):t._e(),t._v(" "),7==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   已退款\n                ")]):t._e(),t._v(" "),8==s.status?a("div",{staticClass:"img_box"},[t._v("\n                   退款中\n                ")]):t._e(),t._v(" "),9==s.status?a("div",{staticClass:"img_box"},[t._v("\n                    进行中\n                ")]):t._e(),t._v(" "),10==s.status?a("div",{staticClass:"img_box"},[t._v("\n                    待审核\n                ")]):t._e()]}},{key:"ticket",fn:function(e){var s=e.row;return[s.num>0?a("div",{staticClass:"img_box"},[t._v("\n                   "+t._s(s.num)+"张\n                ")]):a("div",{staticClass:"img_box"},[t._v("\n                   无\n                ")])]}},{key:"action",fn:function(e){var s=e.row;return[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.bindDetail(s)}}},[t._v("查看详情")]),t._v(" "),1===s.status||10==s.status?a("Button",{attrs:{type:"info"},on:{click:function(e){return t.modalChange("cancleId","show",s)}}},[t._v("取消")]):t._e(),t._v(" "),2===s.status?a("Button",{attrs:{type:"error"},on:{click:function(e){return t.modalChange("refundId","show",s)}}},[t._v("退款")]):t._e()]}}])}),t._v(" "),a("div",{staticClass:"page_box"},[a("div",{staticClass:"page_left"},[t._v("\n                共"+t._s(t.total)+"条记录 第"+t._s(t.page)+"/"+t._s(Math.ceil(t.total/t.pagesize))+"页\n            ")]),t._v(" "),a("div",{staticClass:"page_right"},[a("Page",{attrs:{total:t.total,"page-size":t.pagesize,current:t.page},on:{"on-change":t.changePage}})],1)])],1),t._v(" "),a("Modal",{staticClass:"delete_box",attrs:{"mask-closable":!1,closable:!1,width:"400"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},["cancleId"===t.changeType?a("div",{staticClass:"content"},[a("p",[t._v("您确定要取消选中的订单吗？")])]):t._e(),t._v(" "),"refundId"===t.changeType?a("div",{staticClass:"content"},[a("p",[t._v("您确定要对选中的订单进行退款吗？")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.refund_price,expression:"refund_price"}],attrs:{type:"text",placeholder:"退款金额"},domProps:{value:t.refund_price},on:{input:function(e){e.target.composing||(t.refund_price=e.target.value)}}})]):t._e(),t._v(" "),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"cancle_btn",attrs:{type:"default"},on:{click:function(e){return t.modalChange("refundId","cancle",t.row)}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.bindConfirm}},[t._v("确定")])],1)]),t._v(" "),a("Modal",{staticClass:"detail_modal",attrs:{"mask-closable":!1,closable:!1,title:"定制包车订单",width:"780"},model:{value:t.showDetail,callback:function(e){t.showDetail=e},expression:"showDetail"}},[a("div",{staticClass:"content"},[a("div",{staticClass:"content_top"},[a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("订单类型:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v("定制包车")])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("订单号:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.order_sn))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("订单状态:")]),t._v(" "),1===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("待支付")]):t._e(),t._v(" "),2===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已支付")]):t._e(),t._v(" "),3===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已取消")]):t._e(),t._v(" "),4===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("支付失败")]):t._e(),t._v(" "),5===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已完成")]):t._e(),t._v(" "),6===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已评价")]):t._e(),t._v(" "),7===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("已退款")]):t._e(),t._v(" "),8===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("退款中")]):t._e(),t._v(" "),9===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("进行中")]):t._e(),t._v(" "),10===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("待审核")]):t._e()]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("支付状态:")]),t._v(" "),1===t.detailInfo.status||3===t.detailInfo.status||4===t.detailInfo.status||7===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("支付失败")]):t._e(),t._v(" "),2===t.detailInfo.status||5===t.detailInfo.status||6===t.detailInfo.status||9==t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("支付成功")]):t._e(),t._v(" "),8===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("退款中")]):t._e(),t._v(" "),10===t.detailInfo.status?a("p",{staticClass:"single_right"},[t._v("待审核")]):t._e()]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("取消时间:")]),t._v(" "),t.detailInfo.cancel_time?a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.cancel_time))]):t._e()]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("创建时间:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.created_at))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("用户情况:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.manytimes)+","+t._s(t.detailInfo.service))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("个人预算:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.budget))])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("用户人数:")]),t._v(" "),a("p",{staticClass:"single_right"},[t._v(t._s(t.detailInfo.member)+"成人"+t._s(t.detailInfo.old)+"老人"+t._s(t.detailInfo.child)+"儿童")])]),t._v(" "),a("div",{staticClass:"notice_box"},[a("p",{staticClass:"notice_left"},[t._v("备注：")]),t._v(" "),t.detailInfo.remark?a("p",[t._v(t._s(t.detailInfo.remark))]):a("p",[t._v("无")])])]),t._v(" "),a("div",{staticClass:"content_bottom"},[a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("预订人:")]),t._v(" "),a("p",{staticClass:"single_right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.name,expression:"detailInfo.name"}],attrs:{type:"text",name:"",id:""},domProps:{value:t.detailInfo.name},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"name",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("电话:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.phone,expression:"detailInfo.phone"}],attrs:{type:"text"},domProps:{value:t.detailInfo.phone},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"phone",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("身份证号:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.id_card_number,expression:"detailInfo.id_card_number"}],attrs:{type:"text"},domProps:{value:t.detailInfo.id_card_number},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"id_card_number",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("预约日期:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.stime,expression:"detailInfo.stime"}],attrs:{type:"text"},domProps:{value:t.detailInfo.stime},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"stime",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("结束日期:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.etime,expression:"detailInfo.etime"}],attrs:{type:"text"},domProps:{value:t.detailInfo.etime},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"etime",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("出发地:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.slocation,expression:"detailInfo.slocation"}],attrs:{type:"text"},domProps:{value:t.detailInfo.slocation},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"slocation",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("目的地:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.elocation,expression:"detailInfo.elocation"}],attrs:{type:"text"},domProps:{value:t.detailInfo.elocation},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"elocation",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("成人数:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.member,expression:"detailInfo.member"}],attrs:{type:"text"},domProps:{value:t.detailInfo.member},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"member",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("儿童数:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.child,expression:"detailInfo.child"}],attrs:{type:"text"},domProps:{value:t.detailInfo.child},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"child",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("老人数:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.old,expression:"detailInfo.old"}],attrs:{type:"text"},domProps:{value:t.detailInfo.old},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"old",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("车辆型号:")]),t._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:t.placeholder},on:{"on-change":t.carmodelChoose},model:{value:t.model1,callback:function(e){t.model1=e},expression:"model1"}},t._l(t.carList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),a("div",{staticClass:"single"},[a("p",{staticClass:"single_left"},[t._v("价格:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailInfo.price,expression:"detailInfo.price"}],staticClass:"single_right",domProps:{value:t.detailInfo.price},on:{input:function(e){e.target.composing||t.$set(t.detailInfo,"price",e.target.value)}}})])])]),t._v(" "),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"cancle_btn",attrs:{type:"default"},on:{click:t.closeDeatil}},[t._v("取消")]),t._v(" "),10==t.detailInfo.status?a("Button",{attrs:{type:"primary"},on:{click:t.examine}},[t._v("通过审核")]):t._e(),t._v(" "),1==t.detailInfo.status?a("Button",{attrs:{type:"primary"},on:{click:t.examine}},[t._v("修改订单")]):t._e()],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(l,n,!1,function(t){a("wUKt")},"data-v-d6a8efaa",null);e.default=o.exports},wUKt:function(t,e){}});
//# sourceMappingURL=19.4108ec2508557bfde487.js.map