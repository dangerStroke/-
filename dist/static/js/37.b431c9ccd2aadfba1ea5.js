webpackJsonp([37],{B2Tj:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("bOdI"),s=a.n(i),n={data:function(){return{data:"",page:1,pagesize:12,total:0,modal:!1,modelSelect:"",mainText:"",modalTitle:"",ischange:"",id:"",columnsComment:[{title:"满足程度",key:"type",align:"center",width:"200"},{title:"评价内容",key:"main",align:"center"},s()({title:"操作",slot:"action",width:150,align:"center"},"width","500")],dataComment:[],SelectList:[{value:"满意",label:"满意"},{value:"不满意",label:"不满意"}],satisfyNum:0,unSatisfyNum:0}},methods:{show:function(t){this.id=this.data[t].id,this.ischange=!1,this.modalTitle="修改评价",this.modal=!0,this.modelSelect=this.dataComment[t].type,this.mainText=this.dataComment[t].main},remove:function(t){var e=this;this.$Modal.info({content:"你确定要删除该评价？",onOk:function(){var a={id:e.data[t].id};e.$fetch("/admin/dispatch/del-evaluate",a).then(function(t){console.log(t),200==t.code&&(e.$Message.success({content:"评价删除成功",duration:2}),e.getDataList())}).catch(function(t){e.$Spin.hide()})}})},addOne:function(){console.log(this.satisfyNum,this.unSatisfyNum),this.satisfyNum>=6&&this.unSatisfyNum>=6?this.$Message.error({content:"已不能添加评价",duration:2}):(this.satisfyNum>=6?this.SelectList=[{value:"不满意",label:"不满意"}]:this.unSatisfyNum>=6?this.SelectList=[{value:"满意",label:"满意"}]:this.SelectList=[{value:"满意",label:"满意"},{value:"不满意",label:"不满意"}],this.ischange=!0,this.modelSelect="",this.mainText="",this.modalTitle="添加评价",this.modal=!0)},ok:function(){var t=this;if(console.log(this.mainText,this.modelSelect),this.ischange){var e="";e="满意"===this.modelSelect?1:0,this.modal=!1;var a={title:this.mainText,is_satisfy:e};this.$fetch("/admin/dispatch/add-evaluate",a).then(function(e){200===e.code&&(t.$Message.success({content:"评价添加成功",duration:2}),t.getDataList())}).catch(function(e){t.$Spin.hide()})}else{var i="";i="满意"===this.modelSelect?1:0;var s={title:this.mainText,is_satisfy:i,id:this.id};this.$fetch("/admin/dispatch/edit-evaluate",s).then(function(e){t.$Message.success({content:"评价修改成功",duration:2}),t.getDataList()}).catch(function(e){t.$Spin.hide()})}},cancel:function(){this.modal=!1},changePage:function(t){this.dataComment=[],this.page=t,this.getDataList("page")},getDataList:function(t){var e=this;this.satisfyNum=0,this.unSatisfyNum=0,this.dataComment=[],"page"!==t&&(this.page=1);var a={page:this.page,pagesize:this.pagesize,delflag:0};this.$fetch("/admin/dispatch/list-evaluate",a).then(function(t){if(e.$Spin.hide(),console.log(t.data.data),200===t.code){var a=t.data.data;e.data=a,e.total=t.data.total,e.data.forEach(function(t){var a={type:"",main:""};t.is_satisfy?(e.satisfyNum++,a.type="满意",a.main=t.title,e.dataComment.push(a)):(e.unSatisfyNum++,a.type="不满意",a.main=t.title,e.dataComment.push(a)),console.log(e.satisfyNum)})}else e.$Message.warning("暂无数据")}).catch(function(t){e.$Spin.hide()})}},created:function(){this.$Spin.show(),this.getDataList()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("div",{staticClass:"addBox"},[a("Button",{attrs:{type:"primary"},on:{click:t.addOne}},[a("Icon",{attrs:{type:"md-add"}}),t._v("新建")],1)],1),t._v(" "),a("Table",{attrs:{border:"",columns:t.columnsComment,data:t.dataComment},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row;return[a("strong",[t._v(t._s(i.name))])]}},{key:"action",fn:function(e){e.row;var i=e.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.show(i)}}},[t._v("修改")]),t._v(" "),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.remove(i)}}},[t._v("删除")])]}}])}),t._v(" "),a("div",{staticClass:"page_box"},[a("div",{staticClass:"page_left"},[t._v("\n           共"+t._s(t.total)+"条记录 第"+t._s(t.page)+"/"+t._s(Math.ceil(t.total/t.pagesize))+"页\n       ")]),t._v(" "),a("div",{staticClass:"page_right"},[a("Page",{attrs:{total:t.total,"page-size":t.pagesize,current:t.page},on:{"on-change":t.changePage}})],1)]),t._v(" "),a("Modal",{attrs:{title:t.modalTitle},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[a("div",[t._v("相同类型的评价最多只能添加6条")]),t._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"满意程度"},model:{value:t.modelSelect,callback:function(e){t.modelSelect=e},expression:"modelSelect"}},t._l(t.SelectList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入评价内容",maxlength:"6"},model:{value:t.mainText,callback:function(e){t.mainText=e},expression:"mainText"}})],1)],1)},staticRenderFns:[]};var o=a("VU/8")(n,l,!1,function(t){a("PL4+")},"data-v-34ab81ca",null);e.default=o.exports},"PL4+":function(t,e){}});
//# sourceMappingURL=37.b431c9ccd2aadfba1ea5.js.map