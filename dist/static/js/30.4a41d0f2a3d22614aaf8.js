webpackJsonp([30],{Yv6J:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("fZjL"),o=n.n(a),i={data:function(){return{columns:[{title:"发车日期",key:"date",align:"center"},{title:"单程路线",key:"route",align:"center"},{title:"班次时间",key:"time",align:"center"},{title:"车辆",key:"car_no",align:"center"},{title:"总座位数量",key:"ridership",align:"center"},{title:"余票数量",key:"ticket_numbers",align:"center"},{title:"畅游甘孜售出数量",key:"order",align:"center"},{title:"锁定座位数量",key:"lock_numbers",align:"center"},{title:"操作",slot:"action",width:100,align:"center"}],data:[],page:1,pagesize:10,total:0,one_way_route:"",serachDate:"",routeList:[],modal1:!1,input_locking_num:0,options:{disabledDate:function(t){return t&&t.valueOf()>=(new Date).getTime()+1728e5||t.valueOf()<(new Date).getTime()+-864e5}},formLeft:{}}},created:function(){this.$Spin.show()},mounted:function(){this.getTableData(),this.selectRouteList()},methods:{serachDepartureDate:function(t){console.log(t),this.serachDate=t},selectRouteList:function(){var t=this;this.$fetch("/admin/index/select-route").then(function(e){console.log(e);var n=o()(e.data).map(function(t,n){return{value:t,label:e.data[t]}});t.routeList=n,console.log(n)})},getCarList:function(){console.log("搜索按钮"),this.getTableData()},getTableData:function(t){var e=this,n=this,a={date:this.serachDate||"",route_id:this.one_way_route||""};this.$fetch("/admin/stock/gets",a).then(function(t){console.log(t),200==t.code?(e.$Spin.hide(),console.log(t.data),e.data=t.data):n.$Message.warning(t.error)})},clearSerach:function(){console.log("清空按钮"),this.serachDate="",this.one_way_route="",this.shift_time="",this.getTableData()},locking:function(t){this.modal1=!0,console.log(t),this.formLeft=t},inputNum:function(){if(this.formLeft.lock_numbers>this.formLeft.ticket_numbers)return this.$Message.error("需锁定数量大于了余票数量"),!1},makeSure:function(){var t=this;console.log(this.formLeft),console.log(this.formLeft.lock_numbers),this.$post("/admin/stock/edit",{id:this.formLeft.id,lock_numbers:this.formLeft.lock_numbers}).then(function(e){200==e.code?(t.$Message.info("锁定数量成功"),t.getTableData()):t.$Message.error(e.error)})},cancel:function(){console.log("取消"),this.formLeft={},this.getTableData()},changePage:function(t){this.page=t,this.getTableData("page")}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"intercityInventory_content"},[n("div",{staticClass:"new_site"},[n("div",{staticClass:"inputMsg"},[n("DatePicker",{staticStyle:{width:"156px"},attrs:{type:"date",placeholder:"发车日期",options:t.options},on:{"on-change":t.serachDepartureDate},model:{value:t.serachDate,callback:function(e){t.serachDate=e},expression:"serachDate"}}),t._v(" "),n("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索单程路线"},model:{value:t.one_way_route,callback:function(e){t.one_way_route=e},expression:"one_way_route"}},t._l(t.routeList,function(e){return n("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),n("div",{staticClass:"btns"},[n("Button",{attrs:{type:"primary"},on:{click:t.getCarList}},[t._v("搜索")]),t._v(" "),n("Button",{attrs:{type:"error"},on:{click:t.clearSerach}},[t._v("清空")])],1)]),t._v(" "),n("Table",{attrs:{border:"",columns:t.columns,data:t.data},scopedSlots:t._u([{key:"action",fn:function(e){var a=e.row;return e.index,[n("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.locking(a)}}},[t._v("库存锁定")])]}}])}),t._v(" "),n("div",[n("Modal",{attrs:{title:"库存锁定"},on:{"on-ok":t.makeSure,"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[n("div",{staticClass:"modal_info",model:{value:t.formLeft,callback:function(e){t.formLeft=e},expression:"formLeft"}},[n("span",{staticStyle:{"margin-left":"0px"}},[t._v(t._s(t.formLeft.date))]),t._v(" "),n("span",[t._v(t._s(t.formLeft.time))]),t._v(" "),n("span",[t._v(t._s(t.formLeft.route))]),t._v(" "),n("span",[t._v(t._s(t.formLeft.car_no))])]),t._v(" "),n("div",{staticClass:"modal_info"},[t._v("\n        总座位数量:\n        "),n("span",[t._v(t._s(t.formLeft.ridership))]),t._v("座\n      ")]),t._v(" "),n("div",{staticClass:"modal_info"},[t._v("\n        畅游甘孜售出数量:\n        "),n("span",[t._v(t._s(t.formLeft.order))]),t._v("座\n      ")]),t._v(" "),t.formLeft?n("div",{staticClass:"modal_info"},[t._v("\n        需锁定座位数量:\n        "),n("InputNumber",{staticStyle:{width:"83px","margin-left":"20px"},attrs:{max:t.formLeft.ticket_numbers,min:0},on:{"on-change":t.inputNum},model:{value:t.formLeft.lock_numbers,callback:function(e){t.$set(t.formLeft,"lock_numbers",e)},expression:"formLeft.lock_numbers"}}),t._v(" "),n("span",{staticStyle:{"font-size":"14px"}},[t._v("需锁定数量<=余票数量<=座位总数量")])],1):t._e(),t._v(" "),n("div",{staticClass:"modal_info"},[t._v("\n        余票数量:\n        "),n("span",[t._v(t._s(t.formLeft.ticket_numbers))]),t._v("座\n      ")])])],1)],1)},staticRenderFns:[]};var r=n("VU/8")(i,s,!1,function(t){n("Z2ha")},"data-v-5400dc42",null);e.default=r.exports},Z2ha:function(t,e){}});
//# sourceMappingURL=30.4a41d0f2a3d22614aaf8.js.map