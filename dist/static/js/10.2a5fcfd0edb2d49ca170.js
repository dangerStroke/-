webpackJsonp([10],{"+hfe":function(t,e){},"3IPz":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),n=i.n(a),s={props:{row:Object},data:function(){return{col:[{type:"index",title:"序号",width:80},{title:"车辆",key:"plate_no"},{title:"停放站点",key:"park_name"},{title:"司机",key:"driver_name"},{title:"班次类型",slot:"type"},{title:"班次",slot:"timer"},{title:"操作",align:"center",width:300,slot:"action"}],data:[],routeId:""}},created:function(){this.data=this.row.cars,this.routeId=this.row.id,console.log("线路id"+this.route_id)},methods:{deleteRecord:function(t){this.$emit("removeList",this.row,t)},modifyList:function(t,e){this.$emit("editList",t,e,this.routeId)}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"children_box"},[i("Table",{attrs:{columns:t.col,data:t.data},scopedSlots:t._u([{key:"type",fn:function(e){var a=e.row;return e.index,[i("div",{staticClass:"timer_box"},[1===a.type?i("p",[t._v("按天循环")]):t._e(),t._v(" "),2===a.type?i("p",[t._v("按周循环")]):t._e(),t._v(" "),3===a.type?i("p",[t._v("按日期循环")]):t._e()])]}},{key:"timer",fn:function(e){var a=e.row;return e.index,[1===a.type?i("div",{staticClass:"timer_box"},t._l(a.day,function(e,a,n){return i("div",{key:n},["start"===a?i("p",[t._v("往：")]):t._e(),t._v(" "),"end"===a?i("p",[t._v("返：")]):t._e(),t._v(" "),t._l(e,function(e,a){return i("p",{key:a},t._l(e,function(e,a,n){return i("span",{key:n},[t._v(t._s(e))])}),0)})],2)}),0):t._e(),t._v(" "),2===a.type?i("div",{staticClass:"timer_box"},[i("p",{staticClass:"detail_text",on:{click:function(e){return t.modifyList(a,"detail")}}},[t._v("查看详情")])]):t._e(),t._v(" "),3===a.type?i("div",{staticClass:"timer_box"},t._l(a.date,function(e,a,n){return i("div",{key:n},["start"===a?i("p",[t._v("往：")]):t._e(),t._v(" "),"end"===a?i("p",[t._v("返：")]):t._e(),t._v(" "),t._l(e,function(e,a){return i("p",{key:a},t._l(e,function(e,a,n){return i("span",{key:n},[t._v(t._s(e))])}),0)})],2)}),0):t._e()]}},{key:"action",fn:function(e){var a=e.row;return[i("div",{staticClass:"btn_box"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){return t.modifyList(a,"detail")}}},[t._v("查看详情")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:function(e){return t.modifyList(a,"edit")}}},[t._v("修改")]),t._v(" "),i("Button",{attrs:{type:"error"},on:{click:function(e){return t.deleteRecord(a.id)}}},[t._v("删除")])],1)]}}])})],1)},staticRenderFns:[]};var o=i("VU/8")(s,r,!1,function(t){i("+hfe")},null,null).exports,c={name:"list",data:function(){var t=this;return{routeName:"",route_id:"",car_id:"",driver_id:"",routeList:[],carList:[],driverList:[],columns:[{type:"index",title:"序号",width:80,align:"center"},{title:"线路",key:"name",align:"center"},{title:"司机",key:"age",align:"center"},{title:"城际车辆",key:"address",align:"center"},{title:"操作",slot:"action",align:"center",width:300}],columns10:[{type:"expand",width:50,render:function(e,i){return e(o,{props:{row:i.row,route_id:i.row.station_route_id},on:{removeList:function(e,i){t.deleteRecord(e,i)},editList:function(e,i,a){t.modifyList(e,i,a)},flashData:function(){t.getTimerList("")}}})}},{title:"线路",slot:"station"},{title:"城际车辆",slot:"car"},{title:"司机",slot:"driver"},{title:"操作",slot:"action",align:"center",width:180}],listData:[],page:1,page_size:10,total:0,deleteInfo:{},showDelete:!1}},created:function(){this.$Spin.show(),this.getRouteList(),this.getCarList(),this.getDriverList(),this.getTimerList("")},methods:{modelChange:function(t){"open"===t?this.showDelete=!0:("confirm"===t&&this.submitDelete(),this.showDelete=!1,this.showDelete=!1)},modifyList:function(t,e,i){this.getCarTimers(i,t.id,e)},getCarTimers:function(t,e,i){var a=this;this.$fetch("admin/classes/get?route_id="+t+"&car_id="+e).then(function(n){200===n.code?n.data.is_update||"detail"===i?a.$router.push({name:"modifyFlights",query:{type:i,route_id:t,car_id:e}}):a.$Message.warning("当前车辆存在未完成订单"):a.$Message.warning(n.error)})},deleteRecord:function(t,e){var i={route_id:t.id};e&&(i.car_id=e,i.route_id=t.id),this.deleteInfo=i,this.modelChange("open")},submitDelete:function(){var t=this;this.$post("admin/classes/del",this.deleteInfo).then(function(e){200===e.code?(t.$Message.success("删除成功"),t.getTimerList("")):t.$Message.warning(e.error),t.modelChange("cancle")}).catch(function(e){t.$Spin.hide()})},bindDetail:function(t,e){localStorage.setItem("flights",n()(e)),this.$router.push({name:"flightsEdit",query:{type:t}})},initData:function(){this.route_id="",this.car_id="",this.driver_id="",this.getTimerList("")},getTimerList:function(t){var e=this,i=this.route_id,a=this.car_id,n=this.driver_id;"page"!==t&&(this.page=1);var s={page:this.page,page_size:this.page_size,route_id:i,car_id:a,driver_id:n};this.$fetch("admin/classes/gets",s).then(function(t){200===t.code?(e.listData=t.data.routes,e.total=t.data.total):e.$Message.warning(t.error)}).catch(function(t){e.$Spin.hide()})},addFlights:function(){this.$router.push({name:"addFlights"})},getDriverList:function(){var t=this;this.$fetch("/admin/index/select-driver").then(function(e){if(e.data){var i=e.data,a=[];for(var n in i){var s={name:i[n],value:n};a.push(s)}t.driverList=a}}).catch(function(e){t.$Spin.hide()})},getCarList:function(){var t=this;this.$fetch("/admin/index/select-car").then(function(e){if(e.data){var i=e.data,a=[];for(var n in i){var s={name:i[n],value:n};a.push(s)}t.carList=a}}).catch(function(e){t.$Spin.hide()})},getRouteList:function(){var t=this;this.$fetch("/admin/index/select-route").then(function(e){if(t.$Spin.hide(),200===e.code){if(e.data){var i=e.data,a=[];for(var n in i){var s={name:i[n],value:n};a.push(s)}t.routeList=a}}else t.$Message.warning(e.error)}).catch(function(e){t.$Spin.hide()})},changePage:function(t){this.page=t,this.getTimerList("page")}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flights_list"},[i("div",{staticClass:"search_box"},[i("div",{staticClass:"search_left"},[i("div",{staticClass:"search_single"},[i("Select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择路线"},model:{value:t.route_id,callback:function(e){t.route_id=e},expression:"route_id"}},t._l(t.routeList,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),i("div",{staticClass:"search_single"},[i("Select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择车辆"},model:{value:t.car_id,callback:function(e){t.car_id=e},expression:"car_id"}},t._l(t.carList,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),i("div",{staticClass:"search_single"},[i("Select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择司机"},model:{value:t.driver_id,callback:function(e){t.driver_id=e},expression:"driver_id"}},t._l(t.driverList,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.name))])}),1)],1)]),t._v(" "),i("div",{staticClass:"search_right"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){return t.getTimerList("")}}},[t._v("搜索")]),t._v(" "),i("Button",{attrs:{type:"error"},on:{click:t.initData}},[t._v("清空")]),t._v(" "),i("Button",{staticClass:"add_btn",attrs:{type:"primary"},on:{click:t.addFlights}},[i("Icon",{attrs:{type:"md-add"}}),t._v("新建\n            ")],1)],1)]),t._v(" "),i("div",{staticClass:"table_box"},[i("Table",{attrs:{border:"",columns:t.columns10,data:t.listData},scopedSlots:t._u([{key:"station",fn:function(e){var a=e.row;return e.index,[i("p",[t._v(t._s(a.station1)+" --\x3e "+t._s(a.station2))])]}},{key:"car",fn:function(e){var a=e.row;return e.index,[i("p",[t._v(t._s(a.cars.length)+"辆")])]}},{key:"driver",fn:function(e){var a=e.row;return e.index,[i("p",[t._v(t._s(a.cars.length)+"人")])]}},{key:"action",fn:function(e){var a=e.row;return[i("div",{staticClass:"btn_box"},[i("Button",{attrs:{type:"error"},on:{click:function(e){return t.deleteRecord(a,"")}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),i("Modal",{staticClass:"delete_box",attrs:{"mask-closable":!1,closable:!1,width:"400"},model:{value:t.showDelete,callback:function(e){t.showDelete=e},expression:"showDelete"}},[i("div",{staticClass:"content"},[i("p",[t._v("您确定要删除选中班次吗？")])]),t._v(" "),i("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[i("Button",{staticClass:"cancle_btn",attrs:{type:"default"},on:{click:function(e){return t.modelChange("cancle")}}},[t._v("取消")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.submitDelete}},[t._v("确定")])],1)]),t._v(" "),i("div",{staticClass:"page_box"},[i("div",{staticClass:"page_left"},[t._v("\n                共"+t._s(t.total)+"条记录 第"+t._s(t.page)+"/"+t._s(Math.ceil(t.total/t.page_size))+"页\n            ")]),t._v(" "),i("div",{staticClass:"page_right"},[i("Page",{attrs:{total:t.total,"page-size":t.page_size,current:t.page},on:{"on-change":t.changePage}})],1)])],1)},staticRenderFns:[]};var d=i("VU/8")(c,l,!1,function(t){i("EKXS")},"data-v-7b341ae9",null);e.default=d.exports},EKXS:function(t,e){}});
//# sourceMappingURL=10.2a5fcfd0edb2d49ca170.js.map