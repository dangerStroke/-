webpackJsonp([5],{"/SyM":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),s=a.n(n),i=a("+aT9"),o=a.n(i),r=a("mtWM"),A=a.n(r),l=a("J0sJ"),c=a.n(l),d=a("fAJv"),h=a.n(d),p={name:"areaDetail",data:function(){return{map:{},name:"",points:[],areaId:"",address:"",addressList:[],showList:!1,center:{},cityCode:"",defaultAddress:"",defaultLng:null,defaultLat:null}},created:function(){this.areaId=this.$route.params.id},watch:{defaultAddress:function(){this.geoCode()}},mounted:function(){this.getDetail()},methods:{geoCode:function(){var t=this;new o.a.Geocoder({city:""}).getLocation(t.defaultAddress,function(e,a){console.log("获取经纬度"),console.log(e),console.log(a),"complete"===e&&(t.defaultLng=a.geocodes[0].location.lng,t.defaultLat=a.geocodes[0].location.lat)})},sendPosition:function(){var t=this;if(this.defaultAddress&&this.defaultLat&&this.defaultLng)if(this.name)if(0!==this.points.length){var e=[];this.points.map(function(t){var a=[];a.push(t.lng),a.push(t.lat),e.push(a)});var a={name:this.name,point:s()(e),id:this.areaId,lng:this.defaultLng,lat:this.defaultLat,addr:this.defaultAddress};this.$post("/admin/dispatch/edit-location",a).then(function(e){200===e.code?(t.$Message.success("修改成功"),setTimeout(function(){t.$router.push({name:"areaList"})},1e3)):t.$Message.warning(e.error)}).catch(function(e){t.$Spin.hide(),t.$Message.warning("服务端异常")})}else this.$Message.warning("请选择区域位置");else this.$Message.warning("请填写区域名称");else this.$Message.warning("请默认上车地址")},MapInit:function(){var t=this,e=new o.a.Map("map",{resizeEnable:!0,zoom:15});if(e.on("click",function(a){e.clearMap(),t.center.lat&&t.center.lng&&t.setMarker(t);var n={lat:a.lnglat.lat,lng:a.lnglat.lng};t.points.push(n);var s=[];t.points.map(function(e,a){var n=new o.a.LngLat(e.lng,e.lat);s.push(n),0===a&&t.setStart(t,e.lng,e.lat)});var i=new o.a.Polygon({path:s,fillOpacity:"0.5",fillColor:"#fff",borderWeight:.2,strokeColor:"red"});e.add(i)}),t.map=e,t.points.length>0){var a=[];t.points.map(function(e,n){var s=new o.a.LngLat(e.lng,e.lat);a.push(s),0===n&&t.setStart(t,e.lng,e.lat)});var n=new o.a.Polygon({path:a,fillOpacity:"0.5",fillColor:"#fff",borderWeight:.2,strokeColor:"red"});e.add(n)}e.setCenter(new o.a.LngLat(t.center.lng,t.center.lat))},preStep:function(){if(this.points.length>0){this.map.clearMap(),this.points.pop();var t=[];this.points.map(function(e,a){var n=new o.a.LngLat(e.lng,e.lat);t.push(n)});var e=new o.a.Polygon({path:t,fillColor:"#fff",borderWeight:.2,strokeColor:"red"});this.map.add(e),this.setStart(this,this.points[0].lng,this.points[0].lat)}else this.map.clearMap();this.setMarker(this)},reRender:function(){this.map.clearMap(),this.setMarker(this),this.points=[]},autoInput:function(t){"search"===t&&(this.showList=!1);var e=this;e.address?o.a.plugin("AMap.Autocomplete",function(){new o.a.Autocomplete({}).search(e.address,function(t,a){a.tips&&(e.showList=!0,e.addressList=a.tips)})}):e.getLocation(e.map)},setStart:function(t,e,a){var n=new o.a.Icon({size:new o.a.Size(30,30),image:h.a,imageSize:new o.a.Size(30,30)}),s=new o.a.Marker({position:new o.a.LngLat(e,a),icon:n,offset:new o.a.Pixel(-13,-30)});t.map.add(s)},chooseAddress:function(t){var e={lat:t.location.lat,lng:t.location.lng};this.center=e,this.map.setCenter([t.location.lng,t.location.lat]),this.setMarker(this),this.showList=!1},addressSearch:function(){A.a.get("https://restapi.amap.com/v3/assistant/inputtips",{params:{key:"1f3c1c376736a472b55797bf1c03d6f0",keywords:this.address},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){}).catch(function(t){})},setMarker:function(t){var e=new o.a.Icon({size:new o.a.Size(30,30),image:c.a,imageSize:new o.a.Size(30,30)}),a=new o.a.Marker({position:new o.a.LngLat(t.center.lng,t.center.lat),icon:e,offset:new o.a.Pixel(-13,-30)});t.map.add(a)},getDetail:function(){var t=this;this.$post("/admin/dispatch/get-location",{id:this.areaId}).then(function(e){if(200===e.code){var a=e.data.point;if(a.length>0){var n=[],s=0,i=0,o={};a.map(function(t){var e={lat:t[1],lng:t[0]};s+=t[0],i+=t[1],n.push(e)}),o.lng=(s/a.length).toFixed(6),o.lat=(i/a.length).toFixed(6),t.center=o,t.points=n,t.name=e.data.name,t.defaultAddress=e.data.addr,t.defaultLat=e.data.lat,t.defaultLng=e.data.lng}t.MapInit()}else t.$Message.warning(e.error)}).catch(function(e){t.$Spin.hide(),t.$Message.warning("服务端异常")})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail_container"},[a("div",{attrs:{id:"map"}}),t._v(" "),a("div",{staticClass:"map_content"},[a("div",{staticClass:"name_box"},[a("Input",{attrs:{placeholder:"请输入默认上车点"},model:{value:t.defaultAddress,callback:function(e){t.defaultAddress=e},expression:"defaultAddress"}})],1),t._v(" "),a("div",{staticClass:"search_box"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入地址",id:"tipinput"},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}}),t._v(" "),a("Button",{staticClass:"search_btn",attrs:{type:"primary"},on:{click:function(e){return t.autoInput("search")}}},[t._v("搜索")]),t._v(" "),t.addressList.length>0&&t.showList?a("div",{staticClass:"result_box"},t._l(t.addressList,function(e,n){return a("div",{key:n,staticClass:"single_result",on:{click:function(a){return t.chooseAddress(e)}}},[a("p",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),a("p",{staticClass:"detail"},[t._v(t._s(e.address))])])}),0):t._e()],1),t._v(" "),a("div",{staticClass:"name_box"},[a("Input",{attrs:{placeholder:"请输入区域名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),a("div",{staticClass:"coo_box"},[t.points.length>0?a("Button",{attrs:{type:"primary"},on:{click:t.reRender}},[t._v("重新绘制")]):t._e(),t._v(" "),t.points.length>1?a("Button",{attrs:{type:"primary"},on:{click:t.preStep}},[t._v("上一步")]):t._e(),t._v(" "),t.points.length>0?a("Button",{attrs:{type:"primary"},on:{click:t.sendPosition}},[t._v("修改区域信息")]):t._e()],1),t._v(" "),a("div",{staticClass:"location_box"},[t.points.length>0?a("p",[t._v("已添加的点")]):t._e(),t._v(" "),t._l(t.points,function(e,n){return[a("p",{key:n,staticClass:"single"},[t._v(t._s(e.lng)+","+t._s(e.lat))])]})],2)])])},staticRenderFns:[]};var f=a("VU/8")(p,u,!1,function(t){a("K8+Z")},null,null);e.default=f.exports},J0sJ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAALKADAAQAAAABAAAALAAAAAD8buejAAAFQUlEQVRYCb1Za2gcVRQ+ZzJpklr7JymYlrb4/GMRhShqElzqA0OypUZDq0URofhLCaJi6Q8DIlYpUmgV/GExSqyYkIY8qJRWQx4qJqLWxw8Fpb41SksfJDW7e/zuTXaZ3Jm7c2ez7cBm7j33O9/5cufc1wxTGS5p37yR5i/cS+JtJJJ1JLRW0zL9TsS/EedOUmXVB9z/4cnlhuNSCaSjeQ3NyuMQ2C5CN7nwMNMX+Af6qYbf4N7xGRcfE5NYsDyaqqZ/M52Uk11CtNokdKkj6Bny+CWq9ffxW6NzLj55TCLBkm68lYTfF5H1eYLl3Jn5Z2LZxkOTn7ryeK5ASTc9RDn+qFxiVVxwbdCc6aYHXXU4CZa25mclJz1CUu1K7IpTnOB+V8Vw8YlNCdnS2E5Z6kO+xmJdAtowIBeqoAd4cLLfhlH2oiKkNbWJOPMJHt2qYiTlakNOnyPxb+OR0W9snNaUkK4uD2Lfu1RilUAdi+cP6dgWxVbB9PnxR0BwvcXvopkxp29SsW0BIlNCnmipop/Ofg/BG2yOF9Oup7srL7+O9x+5YMbxTYOu/3hmOwZZYrEI9C38D+P3wyLvtbjfl/RJqY5iaIBv9yJP4RYtmHkrEqoAiisw8RyG725quGsfd3Xlgnjk4/M8fawTc8CLiaZFpSFCcCgl9NI7k/kH5JcFA9vKEHueKvh2Hhw/YcMou2xpvoGy8nEi3jV+nbl0hwfdTPYOV1It0ONdcWIVTmOA1T4Of7QGaDGhYcGeXG2CbHU8nmkaHDtgaw/ZgdU+oQaLIUJLWLBQvcU9bGY+hIHmnOwaC58wkcUSoSUsmBY33xaOJWZPvl5Sd6kk81k4CAR4owS773G54nyAy62YzCekJSwY2e4WGahMbp0zNg9M4hOhJSxYnQZcL5bNrtACLokP07mC32IhLNiTv0yQtS78sLQ2XWVtNxo0Fj6G2V4V+ttsDAsWnjZBtrqeK5nexFIaWoBMH41RWMcFSfuzh0Pr0issuLJqDNGd8xhCUpRu7pYdLaEBkg+l2xRGYZNcK7xJEx7ZM9LWdAzkd5rgYnW9w2J+imorRvLL6cIJO9uKfcmr4Eu0mcIrgSkenrzFjGnZ/NBB9HEiwVqQSB/PyJy0Nf6qA81k1iMFqsygTnX23onChVNCoarr+3SPRXnE2CCwGhu9a/SvRLGIfZpWr+qOChUpmHt7/1PbwSiHS2Jj3s89RyKn10jBWtTN/sGFV0uXRGIhCHr3F6queKVgMAqRgy6Pka2pG2k+M4XHHJ3reWAZ7+xxmocmhm2U9h6GBw+MfomTxB6bc7ntOAz0FhOr4hUVrAXV1L8Aou/KLc7kQ4xTtNJ/0rSb9VjBegCSvw35fNZ0LlcdeZslz9vOvaN/xnHGClYEC29ieAdELzlgxpE7t7M8x0NjR13wToIVEQ9PDBHzbhfSJBh0Qg9et+519XEWrAgxIPbg8UWuQK4BgziIHaeatTuDtrhyIsGarMF/DKIH4ojj2iF2irzaVoyR2ThssL3oPBwEBsvS0bGCZv8YwP6hJWh3LeMfPoGVNMUjE6dcffK45D0MTz1z1PntCHw8T+R6h89XVLny7lLEqhglCVaOegtZ57fh0Q6qussFsRPk+yk+fDR0knDxV5iSBStnLbqh8n4IeVvVi11YGEaopv4erJ6ni+Hi2krKYZMUucyUbnoZW8pnzDZVZ/YOUM0VnUilbFR7EltZBOcD4sPKTpLcazhfVSobyOfxPa4T0+Hrecxy72UVrMQsfMujp/E9L4eu3cvD458tV2TQ/3+Ak7FIyDXYhQAAAABJRU5ErkJggg=="},"K8+Z":function(t,e){},fAJv:function(t,e){t.exports="data:image/png;base64,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"}});
//# sourceMappingURL=5.a1f521423bc2c7b6c3d4.js.map